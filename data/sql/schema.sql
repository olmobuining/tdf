CREATE TABLE album (id BIGINT UNIQUE AUTO_INCREMENT, name VARCHAR(80) NOT NULL, slug VARCHAR(255), UNIQUE INDEX album_sluggable_idx (slug), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE comment (id BIGINT UNIQUE AUTO_INCREMENT, user_id BIGINT NOT NULL, text TEXT NOT NULL, created_at DATETIME NOT NULL, post_id BIGINT, image_id BIGINT, slug VARCHAR(255), UNIQUE INDEX comment_sluggable_idx (slug), INDEX user_id_idx (user_id), INDEX post_id_idx (post_id), INDEX image_id_idx (image_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE image (id BIGINT UNIQUE AUTO_INCREMENT, folder VARCHAR(150) NOT NULL, src VARCHAR(150) NOT NULL UNIQUE, title VARCHAR(80) NOT NULL, text TEXT, user_id BIGINT NOT NULL, created_at DATETIME NOT NULL, slug VARCHAR(255), UNIQUE INDEX image_sluggable_idx (slug), INDEX user_id_idx (user_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE image_album (id BIGINT UNIQUE AUTO_INCREMENT, image_id BIGINT NOT NULL, album_id BIGINT NOT NULL, slug VARCHAR(255), UNIQUE INDEX image_album_sluggable_idx (slug), INDEX image_id_idx (image_id), INDEX album_id_idx (album_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE image_image_type (id BIGINT UNIQUE AUTO_INCREMENT, image_id BIGINT NOT NULL, image_type_id BIGINT NOT NULL, slug VARCHAR(255), UNIQUE INDEX image_image_type_sluggable_idx (slug), INDEX image_id_idx (image_id), INDEX image_type_id_idx (image_type_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE image__type (id BIGINT UNIQUE AUTO_INCREMENT, name VARCHAR(80) NOT NULL, slug VARCHAR(255), UNIQUE INDEX image__type_sluggable_idx (slug), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE permission (id BIGINT UNIQUE AUTO_INCREMENT, name VARCHAR(100) NOT NULL, level BIGINT NOT NULL, slug VARCHAR(255), UNIQUE INDEX permission_sluggable_idx (slug), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE post (id BIGINT UNIQUE AUTO_INCREMENT, title VARCHAR(80) NOT NULL, text TEXT NOT NULL, post_type_id BIGINT NOT NULL, user_id BIGINT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME, slug VARCHAR(255), UNIQUE INDEX post_sluggable_idx (slug), INDEX user_id_idx (user_id), INDEX post_type_id_idx (post_type_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE post__type (id BIGINT UNIQUE AUTO_INCREMENT, name VARCHAR(80) NOT NULL, slug VARCHAR(255), UNIQUE INDEX post__type_sluggable_idx (slug), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE rank (id BIGINT UNIQUE AUTO_INCREMENT, name VARCHAR(100) NOT NULL, slug VARCHAR(255), UNIQUE INDEX rank_sluggable_idx (slug), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE tag (id BIGINT UNIQUE AUTO_INCREMENT, name VARCHAR(50) NOT NULL, slug VARCHAR(255), UNIQUE INDEX tag_sluggable_idx (slug), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE user (id BIGINT UNIQUE AUTO_INCREMENT, username VARCHAR(100) NOT NULL UNIQUE, password VARCHAR(255) NOT NULL, email VARCHAR(255) NOT NULL, rank_id BIGINT NOT NULL, permission_id BIGINT NOT NULL, first_name VARCHAR(100), last_name VARCHAR(100), birthdate DATETIME, slug VARCHAR(255), UNIQUE INDEX user_sluggable_idx (slug), INDEX rank_id_idx (rank_id), INDEX permission_id_idx (permission_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE image_tag (id BIGINT UNIQUE AUTO_INCREMENT, image_id BIGINT NOT NULL, tag_id BIGINT NOT NULL, slug VARCHAR(255), UNIQUE INDEX image_tag_sluggable_idx (slug), INDEX image_id_idx (image_id), INDEX tag_id_idx (tag_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE post_image (id BIGINT UNIQUE AUTO_INCREMENT, image_id BIGINT NOT NULL, post_id BIGINT NOT NULL, slug VARCHAR(255), UNIQUE INDEX post_image_sluggable_idx (slug), INDEX image_id_idx (image_id), INDEX post_id_idx (post_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE post_tag (id BIGINT UNIQUE AUTO_INCREMENT, post_id BIGINT NOT NULL, tag_id BIGINT NOT NULL, slug VARCHAR(255), UNIQUE INDEX post_tag_sluggable_idx (slug), INDEX post_id_idx (post_id), INDEX tag_id_idx (tag_id), PRIMARY KEY(id)) ENGINE = INNODB;
ALTER TABLE comment ADD CONSTRAINT comment_user_id_user_id FOREIGN KEY (user_id) REFERENCES user(id);
ALTER TABLE comment ADD CONSTRAINT comment_post_id_post_id FOREIGN KEY (post_id) REFERENCES post(id);
ALTER TABLE comment ADD CONSTRAINT comment_image_id_image_id FOREIGN KEY (image_id) REFERENCES image(id);
ALTER TABLE image ADD CONSTRAINT image_user_id_user_id FOREIGN KEY (user_id) REFERENCES user(id);
ALTER TABLE image_album ADD CONSTRAINT image_album_image_id_image_id FOREIGN KEY (image_id) REFERENCES image(id);
ALTER TABLE image_album ADD CONSTRAINT image_album_album_id_album_id FOREIGN KEY (album_id) REFERENCES album(id);
ALTER TABLE image_image_type ADD CONSTRAINT image_image_type_image_type_id_image__type_id FOREIGN KEY (image_type_id) REFERENCES image__type(id);
ALTER TABLE image_image_type ADD CONSTRAINT image_image_type_image_id_image_id FOREIGN KEY (image_id) REFERENCES image(id);
ALTER TABLE post ADD CONSTRAINT post_user_id_user_id FOREIGN KEY (user_id) REFERENCES user(id);
ALTER TABLE post ADD CONSTRAINT post_post_type_id_post__type_id FOREIGN KEY (post_type_id) REFERENCES post__type(id);
ALTER TABLE user ADD CONSTRAINT user_rank_id_rank_id FOREIGN KEY (rank_id) REFERENCES rank(id);
ALTER TABLE user ADD CONSTRAINT user_permission_id_permission_id FOREIGN KEY (permission_id) REFERENCES permission(id);
ALTER TABLE image_tag ADD CONSTRAINT image_tag_tag_id_tag_id FOREIGN KEY (tag_id) REFERENCES tag(id);
ALTER TABLE image_tag ADD CONSTRAINT image_tag_image_id_image_id FOREIGN KEY (image_id) REFERENCES image(id);
ALTER TABLE post_image ADD CONSTRAINT post_image_post_id_post_id FOREIGN KEY (post_id) REFERENCES post(id);
ALTER TABLE post_image ADD CONSTRAINT post_image_image_id_image_id FOREIGN KEY (image_id) REFERENCES image(id);
ALTER TABLE post_tag ADD CONSTRAINT post_tag_tag_id_tag_id FOREIGN KEY (tag_id) REFERENCES tag(id);
ALTER TABLE post_tag ADD CONSTRAINT post_tag_post_id_post_id FOREIGN KEY (post_id) REFERENCES post(id);
